<pre class="code">
<span class="srcline"><span class="lineno"><a href="38,23" id="srcline23">23</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="38,24" id="srcline24">24</a></span><span class="line"><span class="keyword">function</span> <span class="var type1" id="S25T119U178">w</span> = fi_twiddles(<span class="mxinfo" id="T5:U2"><span class="mxinfo" id="T5:U3"><span class="var type1" id="S26T5U181">n</span></span></span>) <span class="comment">%#codegen</span></span></span>
<span class="srcline"><span class="lineno"><a href="38,25" id="srcline25">25</a></span><span class="line">    <span class="mxinfo" id="T5:U5"><span class="var type1" id="S27T5U184">t</span> = <span class="mxinfo" id="T5:U7">log2(<span class="var type1" id="S26T5U187">n</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="38,26" id="srcline26">26</a></span><span class="line">    <span class="keyword">if</span> floor(<span class="var type1" id="S27T5U193">t</span>) ~= <span class="var type1" id="S27T5U194">t</span></span></span>
<span class="srcline"><span class="lineno"><a href="38,27" id="srcline27">27</a></span><span class="line">      error(<span class="string">'N must be an exact power of two.'</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="38,28" id="srcline28">28</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="38,29" id="srcline29">29</a></span><span class="line">    <span class="mxinfo" id="T117:U11"><span class="var type1" id="S25T117U201">w</span> = <span class="mxinfo" id="T117:U13">complex(<span class="mxinfo" id="T118:U14">zeros(<span class="var type1" id="S26T5U207">n</span>-1,1)</span>, <span class="mxinfo" id="T5:U16">0</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="38,30" id="srcline30">30</a></span><span class="line">    <span class="mxinfo" id="T5:U17"><span class="var type1" id="S33T5U213">k</span>=<span class="mxinfo" id="T5:U19">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="38,31" id="srcline31">31</a></span><span class="line">    <span class="mxinfo" id="T5:U20"><span class="var type1" id="S34T5U217">L</span>=<span class="mxinfo" id="T5:U22">2</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="38,32" id="srcline32">32</a></span><span class="line">    <span class="keyword">while</span> <span class="mxinfo" id="T3:U23"><span class="var type1" id="S34T5U221">L</span>&lt;=<span class="var type1" id="S26T5U222">n</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="38,33" id="srcline33">33</a></span><span class="line">      <span class="mxinfo" id="T5:U26"><span class="var type1" id="S35T5U225">theta</span> = <span class="mxinfo" id="T5:U28"><span class="mxinfo" id="T5:U29">2*pi</span>/<span class="var type1" id="S34T5U231">L</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="38,34" id="srcline34">34</a></span><span class="line">      <span class="keyword">for</span> <span class="var type1" id="S37T5U234">j</span>=<span class="mxinfo" id="T5:U32">0</span>:(<span class="mxinfo" id="T5:U33"><span class="mxinfo" id="T5:U34"><span class="var type1" id="S34T5U240">L</span>/<span class="mxinfo" id="T5:U36">2</span></span> - <span class="mxinfo" id="T5:U37">1</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="38,35" id="srcline35">35</a></span><span class="line">        <span class="mxinfo" id="T134:U38"><span class="mxinfo" id="T134:U39"><span class="var type1" id="S25T117U246">w</span>(<span class="var type1" id="S33T5U247">k</span>)</span> = <span class="mxinfo" id="T134:U42">complex( <span class="mxinfo" id="T5:U43">cos(<span class="mxinfo" id="T5:U44"><span class="var type1" id="S37T5U253">j</span>*<span class="var type1" id="S35T5U254">theta</span></span>)</span>, <span class="mxinfo" id="T5:U47">-<span class="mxinfo" id="T5:U48">sin(<span class="mxinfo" id="T5:U49"><span class="var type1" id="S37T5U259">j</span>*<span class="var type1" id="S35T5U260">theta</span></span>)</span></span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="38,36" id="srcline36">36</a></span><span class="line">        <span class="mxinfo" id="T5:U52"><span class="var type1" id="S33T5U263">k</span> = <span class="mxinfo" id="T5:U54"><span class="var type1" id="S33T5U265">k</span> + <span class="mxinfo" id="T5:U56">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="38,37" id="srcline37">37</a></span><span class="line">      <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="38,38" id="srcline38">38</a></span><span class="line">      <span class="mxinfo" id="T5:U57"><span class="var type1" id="S34T5U269">L</span> = <span class="mxinfo" id="T5:U59"><span class="var type1" id="S34T5U271">L</span>*<span class="mxinfo" id="T5:U61">2</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="38,39" id="srcline39">39</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="38,40" id="srcline40">40</a></span><span class="line">    <span class="mxinfo" id="T119:U62"><span class="var type1" id="S25T119U275">w</span> = <span class="mxinfo" id="T119:U64">sfi(<span class="var type1" id="S25T117U278">w</span>, 32, 24)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="38,41" id="srcline41">41</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="38,42" id="srcline42">42</a></span><span class="line"></span></span>
</pre>
