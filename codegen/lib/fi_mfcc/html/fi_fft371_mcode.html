<pre class="code">
<span class="srcline"><span class="lineno"><a href="38,1" id="srcline1"> 1</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="38,2" id="srcline2"> 2</a></span><span class="line"><span class="keyword">function</span> <span class="var type1" id="S2T120U3">xc</span> = fi_fft(<span class="var type1" id="S3T116U6">x</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="38,3" id="srcline3"> 3</a></span><span class="line">    assert(isfi(<span class="var type1" id="S3T116U12">x</span>));</span></span>
<span class="srcline"><span class="lineno"><a href="38,4" id="srcline4"> 4</a></span><span class="line">    assert(isequal(numerictype(<span class="var type1" id="S3T116U20">x</span>), numerictype(1, 32, 24)));</span></span>
<span class="srcline"><span class="lineno"><a href="38,5" id="srcline5"> 5</a></span><span class="line">    <span class="comment">%assert(isequal(length(x), n))</span></span></span>
<span class="srcline"><span class="lineno"><a href="38,6" id="srcline6"> 6</a></span><span class="line">    <span class="mxinfo" id="T5:U5"><span class="var type1" id="S8T5U28">n</span> = <span class="mxinfo" id="T5:U7">length(<span class="var type1" id="S3T116U31">x</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="38,7" id="srcline7"> 7</a></span><span class="line">    <span class="mxinfo" id="T5:U9"><span class="var type1" id="S10T5U34">t</span> = <span class="mxinfo" id="T5:U11">log2(<span class="var type1" id="S8T5U37">n</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="38,8" id="srcline8"> 8</a></span><span class="line">    <span class="mxinfo" id="T119:U13"><span class="var type1" id="S12T119U40">w</span> = <span class="mxinfo" id="T119:U15"><span class="fcn" id="F369N4:B42">fi_twiddles</span>(<span class="var type1" id="S8T5U43">n</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="38,9" id="srcline9"> 9</a></span><span class="line">    <span class="mxinfo" id="T116:U17"><span class="var type1" id="S3T116U46">x</span> = <span class="mxinfo" id="T116:U19"><span class="fcn" id="F370N3:B48">fi_bitreverse</span>(<span class="var type1" id="S3T116U49">x</span>,<span class="mxinfo" id="T5:U21"><span class="var type1" id="S8T5U50">n</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="38,10" id="srcline10">10</a></span><span class="line">    <span class="mxinfo" id="T120:U23"><span class="var type1" id="S2T120U53">xc</span> = <span class="mxinfo" id="T120:U25">complex(<span class="var type1" id="S3T116U56">x</span>, <span class="mxinfo" id="T5:U27">0</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="38,11" id="srcline11">11</a></span><span class="line">    <span class="keyword">for</span> <span class="var type1" id="S16T5U60">q</span>=<span class="mxinfo" id="T5:U29">1</span>:<span class="var type1" id="S10T5U63">t</span></span></span>
<span class="srcline"><span class="lineno"><a href="38,12" id="srcline12">12</a></span><span class="line">      <span class="mxinfo" id="T5:U31"><span class="var type1" id="S17T5U66">L</span> = <span class="mxinfo" id="T5:U33"><span class="mxinfo" id="T5:U34">2</span>^<span class="var type1" id="S16T5U69">q</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="38,13" id="srcline13">13</a></span><span class="line">      <span class="mxinfo" id="T5:U36"><span class="var type1" id="S18T5U72">L2</span> = <span class="mxinfo" id="T5:U38"><span class="var type1" id="S17T5U74">L</span>/<span class="mxinfo" id="T5:U40">2</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="38,14" id="srcline14">14</a></span><span class="line">      <span class="mxinfo" id="T5:U41"><span class="var type1" id="S19T5U78">r</span> = <span class="mxinfo" id="T5:U43"><span class="mxinfo" id="T5:U44"><span class="var type1" id="S8T5U80">n</span></span>/<span class="var type1" id="S17T5U81">L</span></span></span>; </span></span>
<span class="srcline"><span class="lineno"><a href="38,15" id="srcline15">15</a></span><span class="line">      <span class="keyword">for</span> <span class="var type1" id="S20T5U84">k</span>=<span class="mxinfo" id="T5:U48">0</span>:(<span class="mxinfo" id="T5:U49"><span class="var type1" id="S19T5U89">r</span>-<span class="mxinfo" id="T5:U51">1</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="38,16" id="srcline16">16</a></span><span class="line">        <span class="keyword">for</span> <span class="var type1" id="S21T5U93">j</span>=<span class="mxinfo" id="T5:U53">0</span>:(<span class="mxinfo" id="T5:U54"><span class="var type1" id="S18T5U98">L2</span>-<span class="mxinfo" id="T5:U56">1</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="38,17" id="srcline17">17</a></span><span class="line">          <span class="mxinfo" id="T52:U57"><span class="var type1" id="S22T52U102">temp</span>          = <span class="mxinfo" id="T52:U59"><span class="mxinfo" id="T47:U60"><span class="var type1" id="S12T119U105">w</span>(<span class="mxinfo" id="T5:U62"><span class="mxinfo" id="T5:U63"><span class="mxinfo" id="T5:U64"><span class="var type1" id="S18T5U109">L2</span>-<span class="mxinfo" id="T5:U66">1</span></span>+<span class="var type1" id="S21T5U111">j</span></span>+<span class="mxinfo" id="T5:U68">1</span></span>)</span> * <span class="mxinfo" id="T47:U69"><span class="var type1" id="S2T120U114">xc</span>(<span class="mxinfo" id="T5:U71"><span class="mxinfo" id="T5:U72"><span class="mxinfo" id="T5:U73"><span class="mxinfo" id="T5:U74"><span class="var type1" id="S20T5U119">k</span>*<span class="var type1" id="S17T5U120">L</span></span>+<span class="var type1" id="S21T5U121">j</span></span>+<span class="var type1" id="S18T5U122">L2</span></span>+<span class="mxinfo" id="T5:U79">1</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="38,18" id="srcline18">18</a></span><span class="line">          <span class="mxinfo" id="T47:U80"><span class="mxinfo" id="T47:U81"><span class="var type1" id="S2T120U127">xc</span>(<span class="mxinfo" id="T5:U83"><span class="mxinfo" id="T5:U84"><span class="mxinfo" id="T5:U85"><span class="mxinfo" id="T5:U86"><span class="var type1" id="S20T5U132">k</span>*<span class="var type1" id="S17T5U133">L</span></span>+<span class="var type1" id="S21T5U134">j</span></span>+<span class="var type1" id="S18T5U135">L2</span></span>+<span class="mxinfo" id="T5:U91">1</span></span>)</span> = <span class="mxinfo" id="T55:U92">bitsra(<span class="mxinfo" id="T55:U93"><span class="mxinfo" id="T47:U94"><span class="var type1" id="S2T120U141">xc</span>(<span class="mxinfo" id="T5:U96"><span class="mxinfo" id="T5:U97"><span class="mxinfo" id="T5:U98"><span class="var type1" id="S20T5U145">k</span>*<span class="var type1" id="S17T5U146">L</span></span>+<span class="var type1" id="S21T5U147">j</span></span>+<span class="mxinfo" id="T5:U102">1</span></span>)</span>  - <span class="var type1" id="S22T52U149">temp</span></span>, 1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="38,19" id="srcline19">19</a></span><span class="line">          <span class="mxinfo" id="T47:U104"><span class="mxinfo" id="T47:U105"><span class="var type1" id="S2T120U154">xc</span>(<span class="mxinfo" id="T5:U107"><span class="mxinfo" id="T5:U108"><span class="mxinfo" id="T5:U109"><span class="var type1" id="S20T5U158">k</span>*<span class="var type1" id="S17T5U159">L</span></span>+<span class="var type1" id="S21T5U160">j</span></span>+<span class="mxinfo" id="T5:U113">1</span></span>)</span>    = <span class="mxinfo" id="T55:U114">bitsra(<span class="mxinfo" id="T55:U115"><span class="mxinfo" id="T47:U116"><span class="var type1" id="S2T120U166">xc</span>(<span class="mxinfo" id="T5:U118"><span class="mxinfo" id="T5:U119"><span class="mxinfo" id="T5:U120"><span class="var type1" id="S20T5U170">k</span>*<span class="var type1" id="S17T5U171">L</span></span>+<span class="var type1" id="S21T5U172">j</span></span>+<span class="mxinfo" id="T5:U124">1</span></span>)</span>  + <span class="var type1" id="S22T52U174">temp</span></span>, 1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="38,20" id="srcline20">20</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="38,21" id="srcline21">21</a></span><span class="line">      <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="38,22" id="srcline22">22</a></span><span class="line">    <span class="keyword"><span class="keyword">end</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="38,23" id="srcline23">23</a></span><span class="line"></span></span>
</pre>
