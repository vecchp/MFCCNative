<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,1" id="srcline1"> 1</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,2" id="srcline2"> 2</a></span><span class="line"><span class="keyword">function</span> <span class="var type1" id="S2T35U3">xc</span> = <span class="message error" id="M1F1C">fi_fft</span>(<span class="var type1" id="S3T1U6">x</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,3" id="srcline3"> 3</a></span><span class="line">    <span class="mxinfo" id="T5:U3"><span class="var type1" id="S4T5U9">n</span> = <span class="mxinfo" id="T5:U5">128</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,4" id="srcline4"> 4</a></span><span class="line">    assert(isfi(<span class="var type1" id="S3T1U16">x</span>));</span></span>
<span class="srcline"><span class="lineno"><a href="1,5" id="srcline5"> 5</a></span><span class="line">    assert(isequal(numerictype(<span class="var type1" id="S3T1U24">x</span>), numerictype(1, 32, 24)));</span></span>
<span class="srcline"><span class="lineno"><a href="1,6" id="srcline6"> 6</a></span><span class="line">    assert(isequal(length(<span class="var type1" id="S3T1U37">x</span>), <span class="var type1" id="S4T5U38">n</span>))</span></span>
<span class="srcline"><span class="lineno"><a href="1,7" id="srcline7"> 7</a></span><span class="line">    <span class="mxinfo" id="T5:U10"><span class="var type1" id="S10T5U41">t</span> = <span class="mxinfo" id="T5:U12">log2(<span class="var type1" id="S4T5U44">n</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,8" id="srcline8"> 8</a></span><span class="line">    <span class="mxinfo" id="T22:U14"><span class="var type1" id="S12T22U47">w</span> = <span class="mxinfo" id="T22:U16"><span class="fcn" id="F46N4:B49">fi_twiddles</span>(<span class="var type1" id="S4T5U50">n</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,9" id="srcline9"> 9</a></span><span class="line">    <span class="mxinfo" id="T1:U18"><span class="var type1" id="S3T1U53">x</span> = <span class="mxinfo" id="T1:U20"><span class="fcn" id="F70N3:B55">fi_bitreverse</span>(<span class="var type1" id="S3T1U56">x</span>,<span class="mxinfo" id="T5:U22"><span class="var type1" id="S4T5U57">n</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,10" id="srcline10">10</a></span><span class="line">    <span class="mxinfo" id="T35:U24"><span class="var type1" id="S2T35U60">xc</span> = <span class="mxinfo" id="T35:U26">complex(<span class="var type1" id="S3T1U63">x</span>, <span class="mxinfo" id="T5:U28">0</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,11" id="srcline11">11</a></span><span class="line">    <span class="keyword">for</span> <span class="var type1" id="S16T5U67">q</span>=<span class="mxinfo" id="T5:U30">1</span>:<span class="var type1" id="S10T5U70">t</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,12" id="srcline12">12</a></span><span class="line">      <span class="mxinfo" id="T5:U32"><span class="var type1" id="S17T5U73">L</span> = <span class="mxinfo" id="T5:U34"><span class="mxinfo" id="T5:U35">2</span>^<span class="var type1" id="S16T5U76">q</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,13" id="srcline13">13</a></span><span class="line">      <span class="mxinfo" id="T5:U37"><span class="var type1" id="S18T5U79">L2</span> = <span class="mxinfo" id="T5:U39"><span class="var type1" id="S17T5U81">L</span>/<span class="mxinfo" id="T5:U41">2</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,14" id="srcline14">14</a></span><span class="line">      <span class="mxinfo" id="T5:U42"><span class="var type1" id="S19T5U85">r</span> = <span class="mxinfo" id="T5:U44"><span class="mxinfo" id="T5:U45"><span class="var type1" id="S4T5U87">n</span></span>/<span class="var type1" id="S17T5U88">L</span></span></span>; </span></span>
<span class="srcline"><span class="lineno"><a href="1,15" id="srcline15">15</a></span><span class="line">      <span class="keyword">for</span> <span class="var type1" id="S20T5U91">k</span>=<span class="mxinfo" id="T5:U49">0</span>:(<span class="mxinfo" id="T5:U50"><span class="var type1" id="S19T5U96">r</span>-<span class="mxinfo" id="T5:U52">1</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,16" id="srcline16">16</a></span><span class="line">        <span class="keyword">for</span> <span class="var type1" id="S21T5U100">j</span>=<span class="mxinfo" id="T5:U54">0</span>:(<span class="mxinfo" id="T5:U55"><span class="var type1" id="S18T5U105">L2</span>-<span class="mxinfo" id="T5:U57">1</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,17" id="srcline17">17</a></span><span class="line">          <span class="mxinfo" id="T42:U58"><span class="var type1" id="S22T42U109">temp</span>          = <span class="mxinfo" id="T42:U60"><span class="mxinfo" id="T36:U61"><span class="var type1" id="S12T22U112">w</span>(<span class="mxinfo" id="T5:U63"><span class="mxinfo" id="T5:U64"><span class="mxinfo" id="T5:U65"><span class="var type1" id="S18T5U116">L2</span>-<span class="mxinfo" id="T5:U67">1</span></span>+<span class="var type1" id="S21T5U118">j</span></span>+<span class="mxinfo" id="T5:U69">1</span></span>)</span> * <span class="mxinfo" id="T36:U70"><span class="var type1" id="S2T35U121">xc</span>(<span class="mxinfo" id="T5:U72"><span class="mxinfo" id="T5:U73"><span class="mxinfo" id="T5:U74"><span class="mxinfo" id="T5:U75"><span class="var type1" id="S20T5U126">k</span>*<span class="var type1" id="S17T5U127">L</span></span>+<span class="var type1" id="S21T5U128">j</span></span>+<span class="var type1" id="S18T5U129">L2</span></span>+<span class="mxinfo" id="T5:U80">1</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,18" id="srcline18">18</a></span><span class="line">          <span class="mxinfo" id="T36:U81"><span class="mxinfo" id="T36:U82"><span class="var type1" id="S2T35U134">xc</span>(<span class="mxinfo" id="T5:U84"><span class="mxinfo" id="T5:U85"><span class="mxinfo" id="T5:U86"><span class="mxinfo" id="T5:U87"><span class="var type1" id="S20T5U139">k</span>*<span class="var type1" id="S17T5U140">L</span></span>+<span class="var type1" id="S21T5U141">j</span></span>+<span class="var type1" id="S18T5U142">L2</span></span>+<span class="mxinfo" id="T5:U92">1</span></span>)</span> = <span class="mxinfo" id="T46:U93">bitsra(<span class="mxinfo" id="T46:U94"><span class="mxinfo" id="T36:U95"><span class="var type1" id="S2T35U148">xc</span>(<span class="mxinfo" id="T5:U97"><span class="mxinfo" id="T5:U98"><span class="mxinfo" id="T5:U99"><span class="var type1" id="S20T5U152">k</span>*<span class="var type1" id="S17T5U153">L</span></span>+<span class="var type1" id="S21T5U154">j</span></span>+<span class="mxinfo" id="T5:U103">1</span></span>)</span>  - <span class="var type1" id="S22T42U156">temp</span></span>, 1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,19" id="srcline19">19</a></span><span class="line">          <span class="mxinfo" id="T36:U105"><span class="mxinfo" id="T36:U106"><span class="var type1" id="S2T35U161">xc</span>(<span class="mxinfo" id="T5:U108"><span class="mxinfo" id="T5:U109"><span class="mxinfo" id="T5:U110"><span class="var type1" id="S20T5U165">k</span>*<span class="var type1" id="S17T5U166">L</span></span>+<span class="var type1" id="S21T5U167">j</span></span>+<span class="mxinfo" id="T5:U114">1</span></span>)</span>    = <span class="mxinfo" id="T46:U115">bitsra(<span class="mxinfo" id="T46:U116"><span class="mxinfo" id="T36:U117"><span class="var type1" id="S2T35U173">xc</span>(<span class="mxinfo" id="T5:U119"><span class="mxinfo" id="T5:U120"><span class="mxinfo" id="T5:U121"><span class="var type1" id="S20T5U177">k</span>*<span class="var type1" id="S17T5U178">L</span></span>+<span class="var type1" id="S21T5U179">j</span></span>+<span class="mxinfo" id="T5:U125">1</span></span>)</span>  + <span class="var type1" id="S22T42U181">temp</span></span>, 1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,20" id="srcline20">20</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,21" id="srcline21">21</a></span><span class="line">      <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,22" id="srcline22">22</a></span><span class="line">    <span class="keyword"><span class="keyword">end</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,23" id="srcline23">23</a></span><span class="line"></span></span>
</pre>
