<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,23" id="srcline23">23</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,24" id="srcline24">24</a></span><span class="line"><span class="keyword">function</span> <span class="var type1" id="S25T22U185">w</span> = fi_twiddles(<span class="mxinfo" id="T5:U2"><span class="mxinfo" id="T5:U3"><span class="var type1" id="S26T5U188">n</span></span></span>) <span class="comment">%#codegen</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,25" id="srcline25">25</a></span><span class="line">    <span class="mxinfo" id="T5:U5"><span class="var type1" id="S27T5U191">t</span> = <span class="mxinfo" id="T5:U7">log2(<span class="var type1" id="S26T5U194">n</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,26" id="srcline26">26</a></span><span class="line">    <span class="keyword">if</span> floor(<span class="var type1" id="S27T5U200">t</span>) ~= <span class="var type1" id="S27T5U201">t</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,27" id="srcline27">27</a></span><span class="line">      error(<span class="string">'N must be an exact power of two.'</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,28" id="srcline28">28</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,29" id="srcline29">29</a></span><span class="line">    <span class="mxinfo" id="T14:U11"><span class="var type1" id="S25T14U208">w</span> = <span class="mxinfo" id="T14:U13">complex(<span class="mxinfo" id="T19:U14">zeros(<span class="var type1" id="S26T5U214">n</span>-1,1)</span>, <span class="mxinfo" id="T5:U16">0</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,30" id="srcline30">30</a></span><span class="line">    <span class="mxinfo" id="T5:U17"><span class="var type1" id="S33T5U220">k</span>=<span class="mxinfo" id="T5:U19">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,31" id="srcline31">31</a></span><span class="line">    <span class="mxinfo" id="T5:U20"><span class="var type1" id="S34T5U224">L</span>=<span class="mxinfo" id="T5:U22">2</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,32" id="srcline32">32</a></span><span class="line">    <span class="keyword">while</span> <span class="mxinfo" id="T3:U23"><span class="var type1" id="S34T5U228">L</span>&lt;=<span class="var type1" id="S26T5U229">n</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,33" id="srcline33">33</a></span><span class="line">      <span class="mxinfo" id="T5:U26"><span class="var type1" id="S35T5U232">theta</span> = <span class="mxinfo" id="T5:U28"><span class="mxinfo" id="T5:U29">2*pi</span>/<span class="var type1" id="S34T5U238">L</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,34" id="srcline34">34</a></span><span class="line">      <span class="keyword">for</span> <span class="var type1" id="S37T5U241">j</span>=<span class="mxinfo" id="T5:U32">0</span>:(<span class="mxinfo" id="T5:U33"><span class="mxinfo" id="T5:U34"><span class="var type1" id="S34T5U247">L</span>/<span class="mxinfo" id="T5:U36">2</span></span> - <span class="mxinfo" id="T5:U37">1</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,35" id="srcline35">35</a></span><span class="line">        <span class="mxinfo" id="T53:U38"><span class="mxinfo" id="T53:U39"><span class="var type1" id="S25T14U253">w</span>(<span class="var type1" id="S33T5U254">k</span>)</span> = <span class="mxinfo" id="T53:U42">complex( <span class="mxinfo" id="T5:U43">cos(<span class="mxinfo" id="T5:U44"><span class="var type1" id="S37T5U260">j</span>*<span class="var type1" id="S35T5U261">theta</span></span>)</span>, <span class="mxinfo" id="T5:U47">-<span class="mxinfo" id="T5:U48">sin(<span class="mxinfo" id="T5:U49"><span class="var type1" id="S37T5U266">j</span>*<span class="var type1" id="S35T5U267">theta</span></span>)</span></span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,36" id="srcline36">36</a></span><span class="line">        <span class="mxinfo" id="T5:U52"><span class="var type1" id="S33T5U270">k</span> = <span class="mxinfo" id="T5:U54"><span class="var type1" id="S33T5U272">k</span> + <span class="mxinfo" id="T5:U56">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,37" id="srcline37">37</a></span><span class="line">      <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,38" id="srcline38">38</a></span><span class="line">      <span class="mxinfo" id="T5:U57"><span class="var type1" id="S34T5U276">L</span> = <span class="mxinfo" id="T5:U59"><span class="var type1" id="S34T5U278">L</span>*<span class="mxinfo" id="T5:U61">2</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,39" id="srcline39">39</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,40" id="srcline40">40</a></span><span class="line">    <span class="mxinfo" id="T22:U62"><span class="var type1" id="S25T22U282">w</span> = <span class="mxinfo" id="T22:U64">sfi(<span class="var type1" id="S25T14U285">w</span>, 32, 24)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,41" id="srcline41">41</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,42" id="srcline42">42</a></span><span class="line"></span></span>
</pre>
